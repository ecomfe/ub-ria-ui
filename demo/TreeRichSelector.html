<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>TreeRichSelector - Demo</title>
    <link rel="stylesheet" href="assets/themes/standard.less" />
    <link href="assets/third-party/prism.css" rel="stylesheet" />
    <script src="assets/loader/esl.js"></script>

    <!--[if lt IE 9]>
    <script src="http://xy3.baidu.com/js/html5.js"></script>
    <![endif]-->
    <script src="assets/third-party/prism.js"></script>
    <script src="assets/third-party/jquery-1.9.1.min.js"></script>

    <script src="demo.js"></script>

    <style>
        .ui-richselector {
            display: inline-block;
            margin: 5px;
        }

        .view {
            background-color: #fff;
            border: 1px solid #eee;
        }

        h3 {
            padding: 20px 10px 10px 0;
        }
    </style>
</head>
<body>
    <h1>TreeRichSelector</h1>
    <div id="page">
        <ul id="navigator">
        </ul>
        <div id="main">
            <h2>树选择</h2>
            <section class="intro">
                <p>树选择</p>
            </section>
            <section class="view">
                <ul class="viewer">
                    <li class="view-markup">结构</li>
                </ul>

                <div class="form-field">
                    <h3>左右多选（单一层级）</h3>
                    <div
                        data-ui-type="CascadingTableRichSelector"
                        data-ui-id="cas-slots"
                        data-ui-name="casSlots"
                        data-ui-item-name="代码位"
                        data-ui-source-title="请选代码位"
                        data-ui-target-title="已选代码位"
                        data-ui-source-empty-text="没有符合条件的代码位"
                        data-ui-target-empty-text="请从左侧选择要添加的代码位"
                        data-ui-has-source-search-box="true"
                        data-ui-has-target-search-box="false"
                        data-ui-has-height="300"
                        data-ui-has-width="200"
                        data-ui-has-search-box="false"
                        data-ui-datasource="@apps">
                        <!--
                        data-ui-disabled="disabled">
                        -->
                    </div>
                </div>

                <div class="form-field">
                    <h3>一级两列列表选择</h3>
                    <div class="form-field-value">
                        <esui-table-rich-selector
                            data-ui-id="all-table-slots"
                            data-ui-title="全部有效代码位"
                            data-ui-has-foot="true"
                            data-ui-has-head="true"
                            data-ui-has-row-head="true"
                            data-ui-need-batch-action="true"
                            data-ui-batch-action-label="选择全部"
                            data-ui-width="275">
                        </esui-table-rich-selector>
                        <esui-table-rich-selector
                            data-ui-id="selected-table-slots"
                            data-ui-title="已选择代码位"
                            data-ui-mode="delete"
                            data-ui-has-search-box="true"
                            data-ui-has-foot="true"
                            data-ui-need-batch-action="true"
                            data-ui-batch-action-label="删除全部"
                            data-ui-empty-text="请从左侧选择要添加的代码位"
                            data-ui-has-row-head="true"
                            data-ui-width="275">
                        </esui-table-rich-selector>
                    </div>
                </div>

                <div class="form-field">
                    <h3>树多选</h3>
                    <div data-ui-type="TreeRichSelector"
                        data-ui-id="tree-all-slots"
                        data-ui-title="全部有效代码位"
                        data-ui-hold-state="true"
                        data-ui-has-foot="false"
                        data-ui-only-leaf-select="false"
                        data-ui-tree-variants="icon angle hoverable"
                        data-ui-need-batch-action="true"
                        data-ui-batch-action-label="选择全部"
                        data-ui-width="275">
                    </div>
                    <div data-ui-type="TreeRichSelector"
                        data-ui-name="adpIds"
                        data-ui-mode="delete"
                        data-ui-id="tree-selected-slots"
                        data-ui-has-search-box="false"
                        data-ui-title="已分配代码位"
                        data-ui-empty-text="请从左侧选择要添加的代码位"
                        data-ui-has-foot="false"
                        data-ui-need-batch-action="true"
                        data-ui-batch-action-label="删除全部"
                        data-ui-hold-state="true"
                        data-ui-only-leaf-select="false"
                        data-ui-width="275"
                        data-ui-validity-label="slot-validity">
                    </div>
                </div>
            </section>
        </div>
    </div>
    <script>
        require(
                [
                    'esui',
                    'CascadingTableRichSelector',
                    'TreeRichSelector'
                ],
                function (ui) {
                    var tables = ui.init(document.body);
                    var table1 = ui.get('cas-slots');

                    var arrayDatasource = [];
                    for (var i = 0; i < 20; i++) {
                        var isSelected = false;
                        if (i == 20) {
                            isSelected = true;
                        }
                        arrayDatasource.push({
                            text: '广告位' + (i + 1),
                            name: '广告位' + (i + 1),
                            prop: '属性' + (i + 1),
                            id: i + 1,
                            isSelected: isSelected
                        })
                    }
                    table1.setProperties({datasource: arrayDatasource, rawValue:[5,7]});

                    var source = ui.get('all-table-slots');
                    var target = ui.get('selected-table-slots');

                    source.setProperties({
                        datasource: arrayDatasource,
                        fields: [
                            {
                                field: 'name',
                                content: function (item) {
                                    return item.name;
                                },
                                searchScope: 'partial',
                                width: 120,
                                title: '名称'
                            },
                            {
                                field: 'value',
                                content: function (item) {
                                    return item.prop;
                                },
                                width: 35,
                                title: '值'
                            }
                        ]
                    });
                    target.setProperties({
                        fields: [
                            {
                                field: 'name',
                                content: function (item) {
                                    return item.name;
                                },
                                isDefaultSearchField: true,
                                searchScope: 'partial',
                                width: 120,
                                title: '名称'
                            },
                            {
                                field: 'value',
                                content: function (item) {
                                    return item.prop;
                                },
                                width: 35,
                                title: '值'
                            }
                        ]
                    });


                    source.on('change', function () {
                        var newdata = this.getSelectedItems();
                        target.setProperties({
                            datasource: newdata
                        })
                    });

                    target.on('delete', function (arg) {
                        var items = arg.items;
                        source.selectItems(arg.items, false);
                    });



                    var treeDatasource = {
                        id: '0',
                        text: '所有广告位',
                        children: []
                    };
                    var children = treeDatasource.children;
                    for (var i = 0; i < 2; i++) {
                        children.push({
                            text: '广告位' + (i + 1),
                            name: '广告位' + (i + 1),
                            id: i + 1,
                            isSelected: true
                        })
                    }

                    for (i = 0; i < children.length; i++) {
                        var node = children[i];
                        node.children = [
                            {
                                text: '子节点' + i,
                                name: '子节点' + (i),
                                id: 100 + i,
                                isSelected: true
                            }
                        ]
                    }

                    var leftTree = ui.get('tree-all-slots');
                    var rightTree = ui.get('tree-selected-slots');

                    leftTree.setProperties({datasource: treeDatasource});

                    leftTree.on('add', function () {
                        var newdata = this.getSelectedTree();
                        rightTree.setProperties({
                            datasource: newdata
                        })
                    });
                    leftTree.fire('add');

                    rightTree.on('delete', function (arg) {
                        var items = arg.items;
                        leftTree.selectItems(arg.items, false);
                    });
                }
        );
    </script>
</body>
</html>
